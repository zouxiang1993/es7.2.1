@startuml
class RoutingTable{
    // 全局的路由表，
    // 封装了所有Index的路由信息
}

class IndexRoutingTable{
    // 封装了单个索引的路由信息
    ---
}

class IndexShardRoutingTable{
    // 封装了单个分片的所有副本实例
    ---
    -ShardId shardId
    -ShardRouting primary
    -List<ShardRouting> replicas
    -List<ShardRouting> shards
    -List<ShardRouting> activeShards
    -List<ShardRouting> assignedShards
    -boolean allShardsStarted
}

class ShardRouting{
    // 单个副本的路由信息
    ---
    -ShardId shardId
    // 当前处在哪个节点上
    -String currentNodeId
    // 正在向哪个节点迁移
    -String relocatingNodeId
    // 是否是主分片
    -boolean primary
    --
    // 当前的状态
    -ShardRoutingState state
    // 在不同的状态持有以下不同的字段
    -RecoverySource recoverySource
    -UnassignedInfo unassignedInfo
    -AllocationId allocationId
}

class ShardId{
    -Index index;
    -int shardId;
}

class Index{
    -String name;
    -String uuid;
}

enum ShardRoutingState{
    UNASSIGNED
    INITIALIZING
    STARTED
    RELOCATING
}

RoutingTable "1" *--right-- "n" IndexRoutingTable
IndexRoutingTable "1" *-- "n" IndexShardRoutingTable
IndexShardRoutingTable "1" *--left-- "n" ShardRouting
ShardRouting *-- ShardId
ShardId *-- Index
ShardRouting *-- ShardRoutingState

@enduml